---
tags:
  - "#os"
---
___
# Terminology
Computer System: focus on the Hardware
Operating System: focus on the Software that manages the Hardware.
___
# Basic Elements
## Operating System
- Manage the hardware resources
- Provides a set of services to users
	- Ex: Create the file, Run program, Access Internet
- Manages secondary memory (USB, SSD) and I/O input (External devices: keyboards, mouse)
## A Computer's Basic Elements
- Processor
- Main Memory
- I/O Modules
- System Bus
## Processor
- Controls the operation of the computer and performs data processing functions.
- When only one processor exists, it is commonly referred to as the Central Processing Unit (CPU).
- Contains internal registers:
    - Memory address register (MAR)
    - Memory buffer register (MBR)
    - I/O address register
    - I/O buffer register
## Main Memory
- **Volatile** (RAM): Data is typically lost when power is removed.
- Referred to as real memory or primary memory.
- Consists of a set of locations defined by sequentially numbered addresses.
	- Contains either data or instructions.
- In contrast, the contents of secondary storage (like disk memory) are retained when the system is shut down
## I/O Modules
- Transfers data from external devices to the processor and memory, and vice versa 
- Moves data between the computer and the external environment such as:
    - Storage (e.g. hard drive)
    - Communications equipment
    - Terminals
- Contains internal buffers for temporarily storing data before they are sent on
- Specified by an I/O Address Register (I/OAR).
## System Bus
- Provides for communication among processors, main memory, and I/O modules.
## Top-Level View

![[Top-Level View.png]]

# Processor Register
- Faster and smaller than main memory.
- **User-visible registers**: Enable the programmer to minimize main memory references by optimizing register use.
    - May be referenced by machine language.
    - Available to all programs (application and system).
    - Types: data, address, condition code registers.
- **Control and status registers**: Used by the processor to control its operation and by privileged OS routines to control the execution of programs.
## Data and Address Registers
- **Data**: Often general purpose, but some may have restrictions.
- **Address**:
    - Index Register
    - Segment pointer
    - Stack pointer
## Control and Status Registers
- **Program counter (PC)**: Contains the address of an instruction to be fetched.
- **Instruction register (IR)**: Contains the instruction most recently fetched.
- **Program status word (PSW)**: Contains status information.
## Condition Codes
- Also called **flags**.
- Bits set by processor hardware as a result of operations.
- Intended for feedback (read-only) regarding the results of an instruction execution.
___
# Instruction Execution
- A program consists of a set of instructions stored in memory.
- **Two steps**:
    1. Processor reads (fetches) instructions from memory.
    2. Processor executes each instruction.
## Basic Instruction Cycle
1.  **Fetch Stage**: Fetch the next instruction.
2.  **Execute Stage**: Execute the instruction.
![[Basic Instruction Cycle.png]]

## Instruction Fetch and Execute
- The processor fetches the instruction from memory.
- The Program Counter holds the address of the next instruction to be fetched and is incremented after each fetch.
- The fetched instruction is loaded into the Instruction Register (IR).
- Instruction categories: Processor-memory, processor-I/O, data processing, control.
___
# Interrupt 
- Interrupt the normal sequencing of the processor
- Provided to improve processor utilisation
	- Most IO devices are slower than the processor
	- The processor must pause to wait for the device
- Example: divide by 0, infinite loop
## Common Classes of Interrupts
| Class                | Description                                                                            |
| :------------------- | :------------------------------------------------------------------------------------- |
| **Program**          | Generated by an instruction execution error (e.g., overflow, division by zero).        |
| **Timer**            | Generated by an internal processor timer to allow the OS to perform regular functions. |
| **I/O**              | Generated by an I/O controller to signal completion or an err_or.                      |
| **Hardware failure** | Generated by a failure like a power outage or memory parity error.                     |
## Instruction Cycle with Interrupts
- The processor checks for interrupts after executing an instruction.
- If an interrupt is pending, it suspends the current program and executes an interrupt handler.
![[Instruction Cycle with Interrupts.png]]
## Multiple Interrupts
- Suppose an interrupt occurs while another interrupt is being processed.
- Two approaches:
    1.  **Disable interrupts** during interrupt processing (Sequential Interrupt Processing).
    2.  Use a **priority scheme** to handle higher-priority interrupts (Nested Interrupt Processing).
## Multiprogramming
- The processor has more than one program to execute.
- The sequence of execution depends on relative priority and whether programs are waiting for I/O.
- After an interrupt handler completes, control may not return to the program that was executing at the time of the interrupt.
___
# The Memory Hierarchy
- Major constraints in memory: Amount, Speed, Expense.
- Trade-offs:
    - Faster access time, greater cost per bit.
    - Greater capacity, smaller cost per bit.
    - Greater capacity, slower access speed.
## Hierarchy Levels
- Going down the hierarchy:
    - Decreasing cost per bit
    - Increasing capacity
    - Increasing access time
    - Decreasing frequency of access to the memory by the processor
___
# Cache Memory
- Invisible to the OS; interacts with other memory management hardware.
- Exploits the **principle of locality** with a small, fast memory to improve performance.
- **Principle of Locality**: Data required soon is often located near the currently accessed data.
## Cache Principles
- Contains a copy of a portion of main memory.
- The processor first checks the cache for data.
- If the data is not found (a miss), a block of memory is read from main memory into the cache.
- Due to locality, future memory references are likely to be in that block.
## Cache Design Issues
- **Cache size**: Small caches still have a significant impact.
- **Block size**: The unit of data exchanged. Larger blocks mean more hits but can reduce the chance of reuse.
- **Mapping function**: Determines which cache location a block will occupy.
- **Replacement algorithm**: Chooses which block to replace when a new block is loaded (e.g., Least Recently Used - LRU).
- **Write policy**: Dictates when a memory write operation takes place.
___
# I/O Communication Techniques
1. **Programmed I/O**: The processor must periodically check the status of the I/O module. The processor waits for the I/O operation to complete. **Inefficient:** keeps the processor busy needlessly and severely degrades performance due to waiting for slow I/O devices
2. **Interrupt-driven I/O**: The processor issues an I/O command and continues with other work. The I/O module interrupts the processor when it is ready. **Improved efficiency** over PIO, but still consumes significant processor time because the CPU handles every word transfer
3. **Direct memory access (DMA)**: An I/O operation is delegated to a separate DMA module. The processor is only involved at the beginning and end of the transfer, allowing it to perform other tasks. DMA is much more efficient. **Highest efficiency** for large transfers, as it enables parallel execution of the CPU and the I/O operation (handled by the DMA module)
___
# Notes
- **Concurrency** = multiple tasks _in progress_ (even if not literally at the same instant).
- **Parallelism** = multiple tasks _running at the same time_ (requires numerous cores/CPUs).





